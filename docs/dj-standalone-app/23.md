# 二十三、协作

开源软件倾向于暗示——尽管它并不*必须*——与其他开发者合作，通常是来自世界各地的陌生人。我们之前的章节很大程度上是基于这样一个想法，即你将与全世界发布和共享你的源代码。这是如此标准的做法，以至于我们很少考虑*为什么*我们会这样做，以及可能的收益和成本，更不用说如何实现它们了。

协作可能是一个挑战，但它几乎总是值得的。在这一章中，我们将会看到你如何期望人们合作，你作为维护者的角色，以及一些最大化这些贡献的有效性和最小化开源维护负担的策略。

## 为什么捐款

从回答“为什么”开始是一个好主意，以允许和促进你的项目中的合作，并理解为什么其他人试图以这样或那样的方式为你的项目做出贡献。

作为维护者，贡献的预期或期望的好处包括:

1.  识别 bug

2.  更新文档

3.  建议功能

4.  开发功能

不管是哪种类型的贡献，大多数贡献背后的共同线索都是希望使用你的软件。用户可能会报告一个错误，因为他们只是想帮忙，让软件变得更好(改善一个富有成效的体验)，或者因为他们想修复这个问题，这样他们就可以开始或继续使用软件(修复一个阻塞的错误)。推荐某个功能的人可能希望在你的应用中看到该功能，因为他们正在使用或想要使用你的应用，而该功能会进一步改进它(至少对他们来说！).

创作和维护开源项目的类似原因也可以在 contributing 中找到。这不仅仅是帮助他人的愿望，也是改进他们自己的技术解决方案的愿望，有时也是希望看到他们的建议获得成功。开源软件永远要考虑虚荣心！

我们可以总结为，贡献的三个动机将是纯粹的帮助或做正确事情的愿望(利他主义)、改进产品供自己使用的愿望(实用性)以及有时看到自己的建议付诸实施的愿望(虚荣心)的某种组合。

## 期待什么

最常见的贡献形式是没有经过充分测试的、记录良好的 pull 请求，这些请求满足了一个提议的特性，甚至解决了一个突出的 bug。最常见的贡献形式是错误报告和特性请求。此外，许多 bug 报告只是简单的问题(有些甚至在文档中有答案)。在某种程度上，这些是对一个项目最简单的“贡献”形式，进入门槛最低。

不管对你的项目有什么贡献，你都需要明白允许和邀请其他人与你合作有好处也有代价。审视和回应问题以及提出要求需要时间，管理他人的期望甚至偶尔的需求也需要情绪能量！有时，即使是善意的人也会忘记或没有意识到这个项目是由其他人管理的，更多的时候是出于他们自己的善意，用他们自己的时间。

因此，无论你能做什么来最小化所有相关方的摩擦，这不仅会提高协作的质量，还会改善你作为维护者的生活。

## 设定期望

有两种策略可以结合使用，以帮助贡献者增加您的项目，同时最大限度地减少需要您做的额外工作。第一个是自动化(已经在第二十四章讨论过),第二个是非常清楚和坦率地说明合作者应该如何贡献，以及反过来对你有什么期望。

从本地运行的脚本到服务器运行的测试和部署过程，自动化的好处是多方面的。一个显著的好处是，当测试和检查由持续集成服务运行时，您不需要自己在本地检查和运行测试来验证新代码。还有一个更具社会性的观点是，为某些决策提供自动化的*预言*减轻了你的决策负担，也减少了当贡献者可能不同意某个决策或因某个决策而感到威胁时的指责焦点。一些简单的例子包括代码格式和覆盖率。如果你已经对这些东西进行了自动检查，即使你已经设置了它们，如果有人的贡献使它们失败了，你不需要说“我不接受这个，因为我做了或看了 X，它不够好”，你可以简单地说“啊，一旦你让东西通过那里，我们可以把它合并进来。”自动化中的规则不太可能让人生气，你需要做的决定和沟通的也更少。

协作过程中总会有一些重要的方面无法自动化，同样，这些可以通过清晰地记录期望来解决或改进。这不仅会让你的生活更轻松，也会让贡献者更轻松，通常会提高他们贡献的质量。

首先是投稿指南，通常包含在顶级独立文件中，如 CONTRIBUTING.rst。这是一个独立文件还是包含在您的自述文件中并不重要，重要的是它包含了什么。在这里，您有机会向潜在用户表达最佳的沟通渠道是什么，他们应该在哪里报告 bug，报告 bug 时应该包括哪些信息，甚至在他们报告 bug 后，对您或其他维护人员有什么期望。

根据您使用的代码发布服务(例如 GitHub、GitLab)，您可以创建模板，协作用户可以根据这些模板生成报告或请求。模板的好处是，您可以提前询问评估问题所需的信息。基于 GitHub 的项目的一个简单问题模板可能如下所示， <sup>1</sup> 它会提示报告者所需的调试信息:

```py
### Bug reports:

Please replace this line with a brief summary of your issue **AND** the  following information:

- [ ] 1\. Python version:
- [ ] 2\. Django version:
- [ ] 3\. MyApp version:
- [ ] 4\. Reproducible test code (if feasible/relevant):

### Features:

**Please note by far the quickest way to get a new feature is to file a Pull Request.**

We will consider your request, but it may be closed if it's something we're not actively planning to work on.

```

同样类型的模板也可以被复制用于拉取请求 <sup>2</sup> :

```py
## Types of changes
<!--- What types of changes does your code introduce? Put an `x` in all the boxes that apply: -->

- [ ] Bug fix (non-breaking change which fixes an issue).
- [ ] New feature (non-breaking change which adds functionality).
- [ ] Breaking change (fix or feature that would cause existing functionality to change).
- [ ] I have read the **CONTRIBUTING** document.
- [ ] My code follows the code style of this project.
- [ ] My change requires a change to the documentation.
- [ ] I have updated the documentation accordingly.
- [ ] I have added tests to cover my changes.
- [ ] All new and existing tests passed.

```

这允许提交者检查他们所代表的已经完成的内容，明确并提前说明期望的内容，使您的审查更容易，并且还将决策和可能的更新请求委托给策略。然而，如果您浏览 pull request 模板，您会注意到至少有几项可以进一步委托给自动化脚本，例如，验证所有测试是否通过，以及在合理的程度上，代码是否匹配期望的项目风格。

你可以考虑的另一个帮助文档的特性是*行为准则*。简而言之，行为准则是一个期望文档，预先声明项目中的协作人员应该如何一起工作和交流。这些变得越来越流行，主要是为了应对开源协作中可能出现的有害或敌对行为。然而，即使你并不十分担心“巨魔”,行为准则也是可以授权的，而不是可以感知的临时决定。

## 维护开放源代码的角色和义务

维护者的角色是什么？你应该如何定义你对用户和贡献者的义务？这些是*故意*刺激的问题，分享了一些关于维护者“工作”的流行假设。简而言之，这两个问题最终都要由你来决定。

维护人员的角色是回答问题和指导开发，这在很大程度上取决于项目开发的活跃程度，包括涉及到多少其他贡献者。如果有积极的贡献者和发展，你可以把你的角色很大程度上变成一个交通警察，给人们指出正确的方向，阻止他们发生事故。或者你可能是所有后续更新的主要作者。

义务的问题更加棘手。这对你所使用的流程没有太大的直接影响，只是对你自己的健康更重要。当你选择免费发布开源软件，人们就会使用它。随后，即使是善意的用户和贡献者也可能会向项目维护人员提出他们认为您有义务满足的请求或要求。这可以从发布新版本到添加新的所需功能。对于采用率高的大项目来说，这可能是压倒性的，对于维护人员来说，即使是在错误的时间的小项目也可能会受到困扰。

回答你的义务这个问题的关键是对我们共享使用的东西负责和你的用户和贡献者使用免费(如“免费啤酒”)软件这一事实之间的矛盾。每一个附属问题都取决于后一个事实，正因为如此，你发布新版本或开发新功能的任何义务都完全是你自己的构建和你免除的自由。

这最终意味着对你发布的 Django 应用的状态和已知问题的状态都要保持坦率和透明。这可能是因为你的应用还没有准备好投入生产，或者某个特定的 bug 需要比你现在更多的时间来解决。你没有义务按照其他人的时间表准备好你的应用，或者修复错误——真的。你甚至没有义务告诉任何人你什么时候会这样做，尽管真诚地努力沟通有助于在当前和潜在的贡献者中建立良好的意愿。

最终，我们的免费开源软件是免费提供的。代码可以被评估，可以被修改以供个人使用，除了明确要求用户支付某种费用的交易，古训*买者自负*“让买家当心”是核心义务。

## 摘要

在这一章中，你已经了解了潜在贡献者希望在你的项目中合作的方式，以及一些鼓励高价值和有效合作的策略。这包括交流如何做出不同种类的贡献，以及如何设想你与项目和用户的关系，以避免感到不知所措。

在下一章，我们将简要介绍如何使用应用模板来创建 Django 独立应用。

<aside aria-label="Footnotes" class="FootnoteSection" epub:type="footnotes">Footnotes 1

基于来自 [` github 的公共领域问题。com/Steve Mao/github-ISSUE-templates/blob/master/check list/ISSUE _ TEMPLATE。md`](https://github.com/stevemao/github-issue-templates)

  2

同样来自 GitHub 问题模板库

 </aside>